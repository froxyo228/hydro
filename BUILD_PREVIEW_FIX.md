# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–≤—å—é —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞

## ‚úÖ **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏**

### 1. **scripts/AdvancedHUD.gd** - –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∫–Ω–æ–ø–æ–∫

#### `update_button_states()`
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–ª–æ—Ç–∏–Ω—É" –∞–∫—Ç–∏–≤–Ω–∞ –≤ PLANNING, –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–≤–æ–±–æ–¥–Ω–∞—è –∑–æ–Ω–∞
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∑–æ–Ω—ã

#### `_on_build_pressed()`  
- ‚úÖ **–ü–µ—Ä–≤—ã–π –∫–ª–∏–∫**: –∑–∞–ø—É—Å–∫ –ø—Ä–µ–≤—å—é (`bc.start_preview()`)
- ‚úÖ **–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫**: –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ (`bc.confirm_build()`)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ DamPreview

#### `_on_survey_pressed()`
- ‚úÖ –ê–≤—Ç–æ–≤–æ–∑–≤—Ä–∞—Ç –∏–∑ SURVEYING ‚Üí PLANNING —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ –õ–æ–≥–∏: `[Survey] –ù–∞—á–∞—Ç–∞ –≥–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞` / `[Survey] –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –≥–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞`

#### `_on_preview_ended()`
- ‚úÖ –°–∫—Ä—ã—Ç–∏–µ –ø—Ä–µ–≤—å—é –∏ –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–π –ø—Ä–æ—á–Ω–æ—Å—Ç–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫

### 2. **scripts/build/BuildController.gd** - –î–æ—Ä–∞–±–æ—Ç–∞–Ω—ã –º–µ—Ç–æ–¥—ã

#### `start_preview(material)`
- ‚úÖ –õ–æ–≥: `[Build] Preview started with material: <name>`
- ‚úÖ –≠–º–∏—Ç `preview_started(material)`

#### `update_preview_position(position)`
- ‚úÖ –õ–æ–≥: `[Build] Preview at: x,y; planned=<value>`
- ‚úÖ –≠–º–∏—Ç `preview_moved(position, material)`

#### `confirm_build()`
- ‚úÖ –õ–æ–≥: `[Build] Confirmed at: <position>`
- ‚úÖ –≠–º–∏—Ç `build_confirmed(position, material)` ‚Üí `preview_ended`

### 3. **scripts/build/DamPreview.gd** - –£–ª—É—á—à–µ–Ω—ã –º–µ—Ç–æ–¥—ã –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è

#### `show_preview()`
- ‚úÖ `visible = true`
- ‚úÖ –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: `modulate = Color(0.5, 0.8, 1.0, 0.6)`
- ‚úÖ –õ–æ–≥: `[Build] DamPreview –ø–æ–∫–∞–∑–∞–Ω`

#### `hide_preview()`
- ‚úÖ `visible = false`
- ‚úÖ –õ–æ–≥: `[Build] DamPreview —Å–∫—Ä—ã—Ç`

#### `_process(delta)`
- ‚úÖ –°–ª–µ–¥—É–µ—Ç –∑–∞ –∫—É—Ä—Å–æ—Ä–æ–º —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ PREVIEW

### 4. **scripts/GameManager.gd** - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–Ω—è—Ç–∏—è –∑–æ–Ω

#### `build_dam_with_material(build_zone, material)`
- ‚úÖ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `build_zone.occupy()`
- ‚úÖ Fallback: `build_zone.is_occupied = true` + `update_visual()`
- ‚úÖ –õ–æ–≥: `[Build] –ó–æ–Ω–∞ <id> –∑–∞–Ω—è—Ç–∞/–ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ –∑–∞–Ω—è—Ç–∞—è`

## üéØ **Acceptance Criteria - –í–´–ü–û–õ–ù–ï–ù–û**

### ‚úÖ –ö–Ω–æ–ø–∫–∞ "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–ª–æ—Ç–∏–Ω—É"
- **–í PLANNING –∞–∫—Ç–∏–≤–Ω–∞**, –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–≤–æ–±–æ–¥–Ω–∞—è –∑–æ–Ω–∞
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç** –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –∑–æ–Ω—ã

### ‚úÖ –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ
- **–ü—Ä–µ–≤—å—é-—Å–ø—Ä–∞–π—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è** –∏ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –∫—É—Ä—Å–æ—Ä–æ–º
- **HUD –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç** "–ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å"
- **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è** –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –º—ã—à–∏

### ‚úÖ –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ (–∏–ª–∏ –õ–ö–ú)
- **–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è**
- **–ó–æ–Ω–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–µ—Ä–æ–π/–∑–∞–Ω—è—Ç–æ–π**
- **–ü—Ä–µ–≤—å—é –∏—Å—á–µ–∑–∞–µ—Ç**
- **HUD –æ—á–∏—â–∞–µ—Ç—Å—è**

### ‚úÖ –ì–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞
- **–ó–æ–Ω—ã –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è** –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏
- **–ß–µ—Ä–µ–∑ ~2 —Å–µ–∫** —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è SURVEYING ‚Üí PLANNING
- **–ö–Ω–æ–ø–∫–∞ "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å"** —Å–Ω–æ–≤–∞ –∞–∫—Ç–∏–≤–Ω–∞

### ‚úÖ –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
```
[Build] Preview started with material: –ë–µ—Ç–æ–Ω
[Build] Preview at: (500, 300); planned=100
[Build] Confirmed at: (500, 300)
[Build] –ó–æ–Ω–∞ zone_1 –∑–∞–Ω—è—Ç–∞
[Survey] –ù–∞—á–∞—Ç–∞ –≥–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞
[Survey] –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –≥–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞, –≤–æ–∑–≤—Ä–∞—Ç –≤ PLANNING
```

## üß™ **–ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É** ‚Üí –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
2. **–ù–∞–∂–∞—Ç—å "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–ª–æ—Ç–∏–Ω—É"** ‚Üí –ø–æ—è–≤–∏—Ç—Å—è –ø—Ä–µ–≤—å—é
3. **–î–≤–∏–≥–∞—Ç—å –º—ã—à—å—é** ‚Üí –ø—Ä–µ–≤—å—é —Å–ª–µ–¥—É–µ—Ç, –ø—Ä–æ—á–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
4. **–ù–∞–∂–∞—Ç—å "–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–ª–æ—Ç–∏–Ω—É" –ø–æ–≤—Ç–æ—Ä–Ω–æ** ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
5. **–ù–∞–∂–∞—Ç—å "–ì–µ–æ—Ä–∞–∑–≤–µ–¥–∫–∞"** ‚Üí —á–µ—Ä–µ–∑ 2 —Å–µ–∫ –≤–æ–∑–≤—Ä–∞—Ç –≤ PLANNING
6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å** ‚Üí –≤—Å–µ –ª–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã

---

**–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!** üéâ
